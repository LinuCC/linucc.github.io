<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="/public/stylesheets/bs.css">
    <link rel="stylesheet" href="/public/stylesheets/styles.css">
    <link rel="stylesheet" href="/public/stylesheets/pygment_trac.css">
    <link href="//maxcdn.bootstrapcdn.com/font-awesome/4.2.0/css/font-awesome.min.css" rel="stylesheet">
    <link rel="canonical" href="linucc.github.io/docker-arch-rpi2">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"></script>
      <link rel="icon" type="image/x-icon"  href="/favicon.ico" />
    <title>Docker with Arch Linux and Raspberry Pi 2 | LinuCC's Sandbox</title>
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
  </head>
  <body>
    <div class="wrapper">
        <section>
          <div id="title">
  <h1>
    
		  <a id="git-ic" href="https://github.com/linucc"><i class="fa fa-github"></i></a>
    

    
      <a id="so-ic" href="http://stackoverflow.com/users/2411498/linucc"><i class="fa fa-stack-overflow"></i></a>
    

    <a id="sitename" href="/">LinuCC's Sandbox</a>
  </h1>

  <!-- Add something about you in p tag-->
  <p>So much to discover, so little time. Continuing to be amazed!</p>
  <hr/>

  <span class="credits left">
  <a href="/blog">Blog</a> | 
  <a href="/archive">Archive</a> |
  <a href="/resume">Resume</a> |
  <a href="/projects">Projects</a> 
</span>

<span class="credits right">

</span>

</div>


          <div class="post-title">
    <h1>Docker with Arch Linux and Raspberry Pi 2</h1>
    <p class="text-muted">02 Mar 2015 | <i class="fa fa-tag"></i>
  
    
  
  
  <a class="text-muted" href="/tags/#docker">docker</a>,
  
  <a class="text-muted" href="/tags/#raspberry-pi-2">raspberry-pi-2</a>,
  
  <a class="text-muted" href="/tags/#arch-linux">arch-linux</a>
  


</p>

</div>

  <p>The new and faster Raspberry Pi 2 finally allows more sophisticated usage of services for home media and networking.
Combine that with the superfast <a href="https://www.docker.com/">Docker</a> for better service management and <a href="https://consul.io/">Consul</a> for health checks and you get an awesome system that is really fun to play with (and possibly a bit overkill ;) )!</p>

<p>I have used the first version of the Raspberry Pi for many tasks.
It was a print-server with cups, a media-center with minidlna and shared files with samba.
It is small, configurable and power-saving.
It also has tons of documentation available online.
The major downside of the Raspberry Pi v1 is its limited ressources:
If I use two services at the same time, it gets really slow with a 700Mhz ARMv6 processor.
Granted, with its 40â‚¬ price tag this is to be expected.
Now along comes the shiny new Raspberry Pi v2.
With a quad-core 900Mhz and 1GB of RAM it should be much faster than its predecessor.
The new processor also features the ARMv7 processor generation, meaning more software will be compatible with the new Raspberry Pi.</p>

<h2 id="basic-setup">Basic setup</h2>

<h3 id="arch-linux">Arch Linux</h3>

<p>Installing Arch Linux on the Raspberry Pi is pretty straightforward.
Just follow the <a href="http://archlinuxarm.org/platforms/armv7/broadcom/raspberry-pi-2">guide on archlinuxarm.org</a>.
If you have an older installation of Arch for the old Raspberry Pi, I recommend you create a fresh installation.
This way you dont need to use the armv6-packages (Possible dependency-hell) or upgrade them to armv7.</p>

<h3 id="docker">Docker</h3>

<p>To install Docker, login to your Raspberry Pi with SSH and type <code>pacman -Syu docker</code> to update the system and install docker.<br />
If you are logged in with a different user than root, you need to add yourself to the docker-group with <code>gpasswd -a user docker</code> and switch to the group with <code>newgrp docker</code>.
Note that the last command will only affect the current session.
Now you only need to start docker <code>systemctl start docker</code> and optionally autostart it on boot with <code>systemctl enable docker</code>.
Check if docker is up and running with <code>docker info</code>.
Thats it!</p>

<h2 id="base-image-for-docker">Base image for Docker</h2>

<p>Since the Raspberry Pi 2 uses a different architecture than the old Raspberry Pi, the kernel differs, too.
This means that we cannot use already existing, prepackaged docker-images for Arch Linux like the repository <a href="https://registry.hub.docker.com/u/cellofellow/rpi-arch/">cellofellow/rpi-arch</a>.
Since there is no base-image for Arch Linux on the Raspberry Pi 2 (I still struggle to create a working and small automatically building image), we have to create it ourselves.</p>

<p>To do that, create a new directory on the Raspberry Pi to store the Dockerfile in.
Fetch the current Arch Linux archive with</p>

<pre><code>curl -L http://archlinuxarm.org/os/ArchLinuxARM-rpi-2-latest.tar.gz -o archlinux.tar.gz
</code></pre>

<p>Then create a new file named <code>Dockerfile</code> with the following content:</p>

<pre><code>FROM scratch

ADD archlinux.tar.gz /

CMD ["/bin/bash"]
</code></pre>

<p>Running <code>docker build -t base-arch-rpi2 .</code> will extract the archive into the root of the new image named <code>base-arch-rpi2</code>.</p>

<p>You can now start a container using the image with <code>docker run -ti base-arch-rpi2</code> or create children with <code>FROM base-arch-rpi2</code> in your Dockerfile.</p>


<!-- <div class="share-btns">
  
 <h4>Share this post:</h4>


 
<a class="btn btn-small btn-sm twitter" href="http://twitter.com/share?text=Docker with Arch Linux and Raspberry Pi 2"
           onclick="window.open(this.href, 'twitter-share', 'width=550,height=235');return false;">
          <i class="fa fa-twitter fa-lg"></i>
          Twitter
        </a>

        <a class="btn btn-small btn-sm facebook" href="https://www.facebook.com/sharer/sharer.php"
           onclick="window.open(this.href, 'facebook-share','width=580,height=296');return false;">
          <i class="fa fa-facebook fa-lg"></i>
          Facebook
        </a>

        <a class="btn btn-small btn-sm gplus"
           onclick="window.open('https://plus.google.com/share?url='+window.location.href, 'google-plus-share', 'width=490,height=530');return false;">
          <i class="fa fa-google-plus fa-lg"></i>
          Google+
        </a>
 </a>

</div>
 -->
<!-- <div class="comments">
   <div id="disqus_thread"></div>
    <script type="text/javascript">
        /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
        var disqus_shortname = 'test'; // REPLACE THIS!!! required: replace example with your forum shortname

        /* * * DON'T EDIT BELOW THIS LINE * * */
        (function() {
            var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script>
    <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
    <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
    
</div>
 -->
<div class="post-footer">
  
</div>
<hr/>


  



          <footer>
<hr/>
  <div class="left">  
    &copy;2015.
    Built with <a href="http://jekyllrb.com/">Jekyll</a> and
    <a href="https://github.com/railsr/autm-rb">Autm-rb</a>
  </div>

  <div class="right">
    
  </div>
</footer>

        </section>
    </div>
    </div>
    <script src="/public/javascripts/jquery.min.js"></script>
    <script src="/public/javascripts/bootstrap.min.js"></script>
    <!-- Place your <script> tags here. -->

<!-- Here, have a comment. No friggin Google analytics or disqus. Just a Blog. -->

<!-- disqus comment counter -->
<!--
<script type="text/javascript">
	/* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
	var disqus_shortname = 'test'; // REPLACE THIS!!! required: replace example with your forum shortname

	/* * * DON'T EDIT BELOW THIS LINE * * */
	(function () {
	    var s = document.createElement('script'); s.async = true;
	    s.type = 'text/javascript';
	    s.src = '//' + disqus_shortname + '.disqus.com/count.js';
	    (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
	}());
</script>
-->
<!-- /disqus comment counter -->



<!-- google analytics -->
<!--
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'PASTE_YOUR_GOOGLE_CODE_HERE', 'auto');
  ga('send', 'pageview');

</script>
-->
<!-- /google analytics -->
  </body>
</html>
